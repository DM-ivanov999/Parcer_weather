# UV Index Weather Parser

ะะฒัะพะผะฐัะธัะตัะบะธะน ะฟะฐััะตั UV-ะธะฝะดะตะบัะฐ ะธ ะฟะพะณะพะดะฝัั ะดะฐะฝะฝัั ะดะปั ะณะพัะพะดะพะฒ ะะฝะดะธะธ ั ะธะฝัะตะณัะฐัะธะตะน ะฒ Supabase ะธ API ะดะปั ะฑะฐะฝะฝะตัะฝะพะน ัะตะบะปะฐะผั.

## ๐ ะะพะทะผะพะถะฝะพััะธ

- โ๏ธ **ะะฐััะธะฝะณ UV-ะธะฝะดะตะบัะฐ** โ ะดะฐะฝะฝัะต ะธะท [Open-Meteo API](https://open-meteo.com) (ะฑะตัะฟะปะฐัะฝะพ, ะฑะตะท ัะตะณะธัััะฐัะธะธ)
- ๐๏ธ **ะะฒะพะนะฝะพะต ััะฐะฝะตะฝะธะต** โ SQLite ะปะพะบะฐะปัะฝะพ + Supabase (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- ๐ **ะะฒัะพะพะฑะฝะพะฒะปะตะฝะธะต** โ GitHub Actions ะบะฐะถะดัะน ัะฐั
- ๐ **HTTP API** โ ะดะปั ะธะฝัะตะณัะฐัะธะธ ั ะฑะฐะฝะฝะตัะฐะผะธ (ััะธะณะณะตัั ะฟะพ UV-ะธะฝะดะตะบัั)
- ๐ **17 ะณะพัะพะดะพะฒ ะะฝะดะธะธ** โ Delhi, Mumbai, Bangalore, ะธ ะดััะณะธะต

## ๐ฆ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
parcer_weather/
โโโ uv_india.py           # ะะฐััะตั UV-ะธะฝะดะตะบัะฐ
โโโ uv_api.py             # HTTP API ะดะปั ะฑะฐะฝะฝะตัะพะฒ
โโโ supabase_schema.sql   # SQL ััะตะผะฐ ะดะปั Supabase
โโโ requirements.txt      # ะะฐะฒะธัะธะผะพััะธ Python
โโโ .env.example          # ะัะธะผะตั ะบะพะฝัะธะณััะฐัะธะธ
โโโ .github/
    โโโ workflows/
        โโโ uv_parser.yml # GitHub Actions cron
```

## ๐ ะัััััะน ััะฐัั

### 1. ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

```bash
pip install -r requirements.txt
```

### 2. ะะพะบะฐะปัะฝัะน ะทะฐะฟััะบ (ะฑะตะท Supabase)

```bash
# ะะฐะฟัััะธัั ะดะปั Delhi (ะฟะพ ัะผะพะปัะฐะฝะธั)
python uv_india.py

# ะะฐะฟัััะธัั ะดะปั ะบะพะฝะบัะตัะฝะพะณะพ ะณะพัะพะดะฐ
python uv_india.py "Mumbai"
python uv_india.py "Bangalore"
```

ะะฐะฝะฝัะต ัะพััะฐะฝััััั ะฒ `uv_data.db` (SQLite).

### 3. ะะฝัะตะณัะฐัะธั ั Supabase (ะพะฟัะธะพะฝะฐะปัะฝะพ)

#### 3.1. ะกะพะทะดะฐัั ัะฐะฑะปะธัั ะฒ Supabase

1. ะะฐะนะดะธัะต ะฒ [Supabase Dashboard](https://app.supabase.com)
2. ะัะบัะพะนัะต **SQL Editor**
3. ะัะฟะพะปะฝะธัะต ัะบัะธะฟั ะธะท `supabase_schema.sql`

#### 3.2. ะะฐัััะพะธัั ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

```bash
# ะกะบะพะฟะธัะพะฒะฐัั ะฟัะธะผะตั
cp .env.example .env

# ะััะตะดะฐะบัะธัะพะฒะฐัั .env
SUPABASE_URL=https://xxxxxxxxxxxxx.supabase.co
SUPABASE_KEY=your-service-role-key
SUPABASE_TABLE=uv_index
```

ะะพะปััะธัั ะบะปััะธ: **Supabase Dashboard โ Settings โ API**

#### 3.3. ะะฐะฟัััะธัั ั Supabase

```bash
# ะะฐะณััะทะธัั ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
export $(cat .env | xargs)

# ะะฐะฟัััะธัั ะฟะฐััะตั
python uv_india.py "Mumbai"
```

ะะฐะฝะฝัะต ะทะฐะฟะธััััั ะฒ **Supabase + SQLite**.

## ๐ค ะะฒัะพะผะฐัะธัะตัะบะธะน ะฟะฐััะธะฝะณ (GitHub Actions)

### ะะฐัััะพะนะบะฐ

1. **Fork ััะพะณะพ ัะตะฟะพะทะธัะพัะธั** ะธะปะธ ัะพะทะดะฐะนัะต ัะฒะพะน
2. **ะะพะฑะฐะฒััะต ัะตะบัะตัั** ะฒ GitHub:
   - `Settings โ Secrets and variables โ Actions โ New repository secret`
   - ะะพะฑะฐะฒััะต:
     - `SUPABASE_URL`
     - `SUPABASE_KEY`

3. **Workflow ะทะฐะฟัััะธััั ะฐะฒัะพะผะฐัะธัะตัะบะธ** ะบะฐะถะดัะน ัะฐั

### ะััะฝะพะน ะทะฐะฟััะบ

1. ะะตัะตะนะดะธัะต ะฒ **Actions**
2. ะัะฑะตัะธัะต **UV Parser**
3. ะะฐะถะผะธัะต **Run workflow**

## ๐ HTTP API ะดะปั ะฑะฐะฝะฝะตัะพะฒ

### ะะฐะฟััะบ API ะปะพะบะฐะปัะฝะพ

```bash
python uv_api.py --host 0.0.0.0 --port 8080
```

### ะญะฝะดะฟะพะธะฝัั

#### `GET /health`

ะัะพะฒะตัะบะฐ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ API.

**ะัะฒะตั:**
```json
{
  "ok": true
}
```

#### `GET /banner/uv`

ะะพะปััะธัั UV-ะธะฝะดะตะบั ั ะฟัะพะฒะตัะบะพะน ััะธะณะณะตัะฐ ะดะปั ะฑะฐะฝะฝะตัะฐ.

**ะะฐัะฐะผะตััั:**
- `city` (optional) โ ะณะพัะพะด (ะฟะพ ัะผะพะปัะฐะฝะธั: `Delhi`)
- `threshold` (optional) โ ะฟะพัะพะณ UV ะดะปั ััะธะณะณะตัะฐ (ะฟะพ ัะผะพะปัะฐะฝะธั: `6`)
- `op` (optional) โ ะพะฟะตัะฐัะพั ััะฐะฒะฝะตะฝะธั: `gte`, `gt`, `lte`, `lt`, `eq` (ะฟะพ ัะผะพะปัะฐะฝะธั: `gte`)
- `fresh` (optional) โ ะฟัะธะฝัะดะธัะตะปัะฝะพ ะพะฑะฝะพะฒะธัั ะดะฐะฝะฝัะต: `1`, `true` (ะฟะพ ัะผะพะปัะฐะฝะธั: `0`)

**ะัะธะผะตั ะทะฐะฟัะพัะฐ:**

```bash
# ะัะพะฒะตัะธัั, UV >= 6 ะดะปั Mumbai
curl "http://localhost:8080/banner/uv?city=Mumbai&threshold=6&op=gte"

# ะัะธะฝัะดะธัะตะปัะฝะพ ะพะฑะฝะพะฒะธัั ะดะฐะฝะฝัะต ะดะปั Delhi
curl "http://localhost:8080/banner/uv?city=Delhi&fresh=1"
```

**ะัะธะผะตั ะพัะฒะตัะฐ:**

```json
{
  "ok": true,
  "city": "Mumbai",
  "timestamp": "2026-02-10T16:53:51.365338",
  "uv_index": 5.2,
  "uv_desc": "Moderate",
  "trigger": {
    "op": "gte",
    "threshold": 6,
    "matched": false
  },
  "banner_payload": {
    "uv": 5.2,
    "show_uv_creative": false
  }
}
```

### ะะฝัะตะณัะฐัะธั ั ะฑะฐะฝะฝะตัะฐะผะธ

ะัะฟะพะปัะทัะนัะต `banner_payload.show_uv_creative` ะดะปั ะฟะพะบะฐะทะฐ UV-ะบัะตะฐัะธะฒะฐ:

```javascript
// ะัะธะผะตั ะธะฝัะตะณัะฐัะธะธ
fetch('https://your-api.com/banner/uv?city=Mumbai&threshold=6&op=gte')
  .then(r => r.json())
  .then(data => {
    if (data.banner_payload.show_uv_creative) {
      // ะะพะบะฐะทะฐัั UV-ะบัะตะฐัะธะฒ (ัะพะปะฝัะตะทะฐัะธัะฝัะน ะบัะตะผ, ะพัะบะธ ะธ ั.ะด.)
      showUVCreative(data.uv_index);
    } else {
      // ะะพะบะฐะทะฐัั ะพะฑััะฝัะน ะบัะตะฐัะธะฒ
      showDefaultCreative();
    }
  });
```

## ๐บ๏ธ ะะพะดะดะตัะถะธะฒะฐะตะผัะต ะณะพัะพะดะฐ

| ะะพัะพะด | ะะพะพัะดะธะฝะฐัั |
|-------|-----------|
| Delhi | 28.6139ยฐN, 77.2090ยฐE |
| Mumbai | 19.0760ยฐN, 72.8777ยฐE |
| Bangalore | 12.9716ยฐN, 77.5946ยฐE |
| Hyderabad | 17.3850ยฐN, 78.4867ยฐE |
| Chennai | 13.0827ยฐN, 80.2707ยฐE |
| Kolkata | 22.5726ยฐN, 88.3639ยฐE |
| Pune | 18.5204ยฐN, 73.8567ยฐE |
| Ahmedabad | 23.0225ยฐN, 72.5714ยฐE |
| Jaipur | 26.9124ยฐN, 75.7873ยฐE |
| Goa | 15.2993ยฐN, 74.1240ยฐE |
| Lucknow | 26.8467ยฐN, 80.9462ยฐE |
| Chandigarh | 30.7333ยฐN, 76.7794ยฐE |
| Kochi | 9.9312ยฐN, 76.2673ยฐE |
| Varanasi | 25.3176ยฐN, 82.9739ยฐE |
| Agra | 27.1767ยฐN, 78.0081ยฐE |
| Surat | 21.1702ยฐN, 72.8311ยฐE |
| Indore | 22.7196ยฐN, 75.8577ยฐE |

ะงัะพะฑั ะดะพะฑะฐะฒะธัั ะณะพัะพะด, ะพััะตะดะฐะบัะธััะนัะต ัะปะพะฒะฐัั `CITIES` ะฒ `uv_india.py`.

## ๐ UV Index ััะพะฒะฝะธ

| UV Index | ะฃัะพะฒะตะฝั | ะะตะบะพะผะตะฝะดะฐัะธะธ |
|----------|---------|--------------|
| 0-2 | Low | ะะตะทะพะฟะฐัะฝะพ, ะทะฐัะธัะฐ ะฝะต ััะตะฑัะตััั |
| 3-5 | Moderate | ะัะฟะพะปัะทัะนัะต ัะพะปะฝัะตะทะฐัะธัะฝัะน ะบัะตะผ |
| 6-7 | High | ะะฐัะธัะฐ ะพะฑัะทะฐัะตะปัะฝะฐ (ะบัะตะผ SPF 30+) |
| 8-10 | Very High | ะะทะฑะตะณะฐะนัะต ัะพะปะฝัะฐ 10:00-16:00 |
| 11+ | Extreme | ะะฐะบัะธะผะฐะปัะฝะฐั ะทะฐัะธัะฐ, ะธะทะฑะตะณะฐะนัะต ัะพะปะฝัะฐ |

## ๐๏ธ ะขะตัะฝะพะปะพะณะธะธ

- **Python 3.9+**
- **Open-Meteo API** โ ะฑะตัะฟะปะฐัะฝัะน ะธััะพัะฝะธะบ ะฟะพะณะพะดะฝัั ะดะฐะฝะฝัั
- **SQLite** โ ะปะพะบะฐะปัะฝะพะต ััะฐะฝะตะฝะธะต
- **Supabase** โ ะพะฑะปะฐัะฝะฐั PostgreSQL ะฑะฐะทะฐ (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- **GitHub Actions** โ ะฐะฒัะพะผะฐัะธัะตัะบะธะน ะฟะฐััะธะฝะณ ะฟะพ ัะฐัะฟะธัะฐะฝะธั

## ๐ ะะธัะตะฝะทะธั

ะญัะพั ะฟัะพะตะบั ัะพะทะดะฐะฝ ะดะปั ะพะฑัะฐะทะพะฒะฐัะตะปัะฝัั ะธ ะบะพะผะผะตััะตัะบะธั ัะตะปะตะน. ะัะฟะพะปัะทัะนัะต ัะฒะพะฑะพะดะฝะพ.

## ๐ค ะะพะฝัะฐะบัั

ะัะธ ะฒะพะทะฝะธะบะฝะพะฒะตะฝะธะธ ะฒะพะฟัะพัะพะฒ ัะพะทะดะฐะฒะฐะนัะต [Issue](https://github.com/DM-ivanov999/Parcer_weather/issues).

---

**ะกะพะทะดะฐะฝะพ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ Claude Code** ๐ค
